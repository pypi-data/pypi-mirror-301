deploy.pypi:
  stage: deploy
  variables:
    GIT_DEPTH: 0
  image: ghcr.io/astral-sh/uv:python3.12-alpine
  before_script:
    - apk add git
    - uv build
  script:
    - uv publish -u __token__ -p $PYPI_TOKEN
  only:
    refs:
      - tags
    variables:
      - $CI_COMMIT_REF_NAME =~ /[0-9]+.[0-9]+.[0-9]+.*/
