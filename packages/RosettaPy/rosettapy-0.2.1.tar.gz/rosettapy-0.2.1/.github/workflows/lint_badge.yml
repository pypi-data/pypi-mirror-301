name: Pylint

on:
  workflow_dispatch:

  push:
    paths:
      - '.github/workflows/lint_badge.yml' # monitor the main workflow script.
      - 'tests/*.py' # monitor the unit tests
      - 'src/*' # monitor the REvoDesign project source code
      - '!CHANGELOG.md'
    branches:
        - main

env:
  lint-python-version: '3.11'

jobs:
  UpdateLinting:
    runs-on: 'ubuntu-latest'

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
            python-version: ${{ env.lint-python-version }}

      - name: Install Packages
        run:
            pip install '.[test]'

      - name: Linting
        uses: YaoYinYing/pylint-github-action@3975648a269de4f22403ff78ec53736dba2206c2
        with:
          lint-path: src  # lint src package
          python-version: ${{ env.lint-python-version }}  # python version which will lint the package
          badge-text: pylint score
          badge-file-name: pylint_scan
          badge-artifact-name: upload-my-awesome-badge-${{ github.run_id }}
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          R2_BUCKET: ${{ secrets.R2_BUCKET }}
          R2_badge_path: badge_dir_with_uniq_name/RosettaPy/pylint
