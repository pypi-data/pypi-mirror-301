<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>stingray.workbook &#8212; Stingray-Reader 5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=4af8989d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="stingray.implementations" href="stingray.implementations.html" />
    <link rel="prev" title="stingray.cobol_parser" href="stingray.cobol_parser.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-stingray.workbook">
<span id="stingray-workbook"></span><h1>stingray.workbook<a class="headerlink" href="#module-stingray.workbook" title="Link to this heading">¶</a></h1>
<p>workbook – Row, Sheet, and Workbook Definitions.</p>
<p>The Stingray Reader treats all workbooks alike.
This means wrapping CSV files, Numbers_13, ODS, and XLSX files
with a <strong>Facade</strong> of <a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code></a>, <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a>, and <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a>
These classes describe the relevant features of these file formats.</p>
<p>This includes the following built-in workbook formats:</p>
<ul class="simple">
<li><p>CSV via built-in <code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code> module.</p></li>
<li><p>NDJSON a/k/a JSON Newline via the built-in <code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code> module.</p></li>
<li><p>COBOL files in EBCDIC via the <a class="reference internal" href="stingray.estruct.html#module-stingray.estruct" title="stingray.estruct"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stingray.estruct</span></code></a> module.</p></li>
<li><p>COBOL files in native Text</p></li>
<li><p>TAB via CSV reader with dialetc options</p></li>
<li><p>Pure Text via External Schema.
See <code class="docutils literal notranslate"><span class="pre">workbook.simple</span></code> and the metadata in <code class="docutils literal notranslate"><span class="pre">simple.csv</span></code>.</p></li>
</ul>
<p>Other formats are in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">implementations</span></code> module.</p>
<section id="cobol-file-implementation-ebcdic-and-text">
<h2>COBOL File Implementation – EBCDIC and Text<a class="headerlink" href="#cobol-file-implementation-ebcdic-and-text" title="Link to this heading">¶</a></h2>
<p>The EBCDIC files require specific physical “Record Format” (RECFM) assistance.
These classes define a number of Z/OS RECFM conversion.
The <code class="xref py py-mod docutils literal notranslate"><span class="pre">estruct</span></code> module has classes for four actual RECFM’s plus an additional special case.</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_F</span></code> - Fixed.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_FB</span></code> - Fixed Blocked.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_V</span></code> - Variable, data has RDW preceeding each record.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_VB</span></code> - Variable Blocked, data must have BDW and RDW words.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_N</span></code> - Variable, but no BDW or RDW words. This involves some buffer management
magic to recover the records properly. This is required to handle Occurs Depending On cases
where there’s no V or VB header. This requires the consumer of bytes to announce how many bytes
where needed so the reader can advance an appropriate amount.</p></li>
</ul>
</section>
<p>The definitions are mostly protocols to handle non-delimited (i.e., COBOL files), delimited files, and workbooks.
This depends on the lower-level <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code>, and <code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code> constructs.</p>
<p class="plantuml">
<img src="../../_images/plantuml-36028599afce93be6927c56d6146616ab7a8f6b2.png" alt="&#64;startuml
    abstract class Schema
    abstract class Unpacker
    class Location
    Location --&gt; Schema
    'abstract class NDInstance
    'Location -&gt; NDInstance
    class LocationMaker {
        from_instance(instance): Location
    }
    Unpacker --&gt; LocationMaker
    LocationMaker --&gt; &quot;n&quot; Location : creates
    /'Details...
    abstract class Nav
    class NDNav
    class DNav
    class WBNav
    Nav &lt;|-- NDNav
    Nav &lt;|-- DNav
    Nav &lt;|-- WBNav

    Unpacker --&gt; NDNav : creates
    Unpacker --&gt; DNav : creates

    NDNav --&gt; Location

    class JSON
    DNav --&gt; JSON
    '/

    class File
    abstract class Workbook ##[bold]blue

    Workbook --&gt; Unpacker
    Workbook --&gt; File : opens
    Unpacker --&gt; File : reads

    class Sheet ##[bold]blue {
        row_iter(): Row
    }
    Workbook *-- &quot;1:n&quot; Sheet
    Sheet --&gt; Schema
    class Row  ##[bold]blue {
        name(): Any
    }
    Sheet *-- &quot;n&quot; Row
    Row --&gt; NDNav : &quot;[non-delimited]&quot;
    Row --&gt; DNav : &quot;[delimited]&quot;
    Row --&gt; WBNav : &quot;[workbook]&quot;
    class EmbeddedSchemaSheet
    class ExternalSchemaSheet
    Sheet &lt;|-- EmbeddedSchemaSheet
    Sheet &lt;|-- ExternalSchemaSheet
    class SchemaLoader
    EmbeddedSchemaSheet --&gt; SchemaLoader
    ExternalSchemaSheet --&gt; SchemaLoader
    SchemaLoader --&gt; Schema : creates
&#64;enduml"/>
</p>
<p>Here are some additional side-bar considerations for other formats that depend on external modules.</p>
<ul class="simple">
<li><p>CSV is built-in. We permit kwargs to provide additional dialect details.</p></li>
<li><p>JSON is built-in.  We’ll treate newline delimited JSON like CSV.</p></li>
<li><p>XLS is a weird proprietary thing. The <code class="docutils literal notranslate"><span class="pre">xlrd</span></code> project (<a class="reference external" href="https://pypi.org/project/xlrd/">https://pypi.org/project/xlrd/</a>) supports it.</p></li>
<li><p>ODS and XLSX are XML files. Incremental parsing is helpful here because they can be large. See <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/">https://openpyxl.readthedocs.io/en/stable/</a> and <a class="reference external" href="http://docs.pyexcel.org/en/v0.0.6-rc2/">http://docs.pyexcel.org/en/v0.0.6-rc2/</a>.</p></li>
<li><p>Numbers uses protobuf. The legacy version of Stingray Reader had  protobuf definitions which appear to work and a snappy decoder. See <a class="reference external" href="https://pypi.org/project/numbers-parser/">https://pypi.org/project/numbers-parser/</a> for the better solution currently in use.</p></li>
<li><p>TOML requires an external library.  An <code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code> subclass can decompose a “one big list” TOML document into individual rows.</p></li>
<li><p>YAML requires an external library. We’ll use the iterative parser as a default. An <code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code> subclass can decompose a “one big list” YAML document into individual rows.</p></li>
<li><p>XML is built-in. A schema can drive navgiation through the XML document, name the various tags of interest. Other tags which may be present would be ignored.</p></li>
</ul>
<p>A given workbook has two possible sources for a schema: internal and external. An internal schema might be the first row or it might require more sophisticated parsing. An external schema might be hard-coded in the application, or might be a separate document with its own meta-schema.</p>
<p>Generally, the schema applies to a sheet (or a Table in a Workspace for Numbers.)</p>
<section id="api-concept">
<h2>API Concept<a class="headerlink" href="#api-concept" title="Link to this heading">¶</a></h2>
<p>A “fluent” interface is used to open a sheet, extract a header, and process rows. The alternative is to open a sheet, apply the externally loaded schema, and use this to process the sheet’s rows.
Once a sheet has been bound to a schema, the rows can be processed.</p>
<p><strong>Internal, Embedded Schema</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stingray</span> <span class="kn">import</span> <span class="n">open_workbook</span><span class="p">,</span> <span class="n">HeadingRowSchemaLoader</span><span class="p">,</span> <span class="n">Row</span>
<span class="go">    &gt;&gt;&gt; from pathlib import Path</span>
<span class="go">    &gt;&gt;&gt; import os</span>
<span class="go">    &gt;&gt;&gt; from typing import Iterable</span>
<span class="go">    &gt;&gt;&gt; source_path = Path(os.environ.get(&quot;SAMPLES&quot;, &quot;sample&quot;)) / &quot;Anscombe_quartet_data.csv&quot;</span>

<span class="go">    &gt;&gt;&gt; def process_sheet(rows: Iterable[Row]) -&gt; None:</span>
<span class="go">    ...     for row in rows:</span>
<span class="go">    ...         row.dump()</span>
<span class="go">    ...         break  # Stop after 1 row.</span>

<span class="go">    &gt;&gt;&gt; with open_workbook(source_path) as workbook:</span>
<span class="go">    ...    sheet = workbook.sheet(&#39;Sheet1&#39;)</span>
<span class="go">    ...    _ = sheet.set_schema_loader(HeadingRowSchemaLoader())</span>
<span class="go">    ...    process_sheet(sheet.rows())</span>
<span class="go">    Field                                                 Value</span>
<span class="go">    object</span>
<span class="go">      x123                                                &#39;10.0&#39;</span>
<span class="go">      y1                                                  &#39;8.04&#39;</span>
<span class="go">      y2                                                  &#39;9.14&#39;</span>
<span class="go">      y3                                                  &#39;7.46&#39;</span>
<span class="go">      x4                                                  &#39;8.0&#39;</span>
<span class="go">      y4                                                  &#39;6.58&#39;</span>


<span class="go">In this case, the :py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAMPLES&quot;</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="s2">&quot;Anscombe_quartet_data.csv&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">process_sheet</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Row</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">row</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="gp">... </span>        <span class="k">break</span>  <span class="c1"># Stop after 1 row.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">sheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">set_schema_loader</span><span class="p">(</span><span class="n">HeadingRowSchemaLoader</span><span class="p">())</span>
<span class="gp">... </span>   <span class="n">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">())</span>
<span class="go">Field                                                 Value</span>
<span class="go">object</span>
<span class="go">  x123                                                &#39;10.0&#39;</span>
<span class="go">  y1                                                  &#39;8.04&#39;</span>
<span class="go">  y2                                                  &#39;9.14&#39;</span>
<span class="go">  y3                                                  &#39;7.46&#39;</span>
<span class="go">  x4                                                  &#39;8.0&#39;</span>
<span class="go">  y4                                                  &#39;6.58&#39;</span>
</pre></div>
</div>
<p>In this case, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">rows()</span></code> method of the <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance will exclude the header rows consumed
by the <a class="reference internal" href="#stingray.workbook.HeadingRowSchemaLoader" title="stingray.workbook.HeadingRowSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeadingRowSchemaLoader</span></code></a>.</p>
<p><strong>External Schema</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stingray</span> <span class="kn">import</span> <span class="n">open_workbook</span><span class="p">,</span> <span class="n">ExternalSchemaLoader</span><span class="p">,</span> <span class="n">Row</span><span class="p">,</span> <span class="n">SchemaMaker</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAMPLES&quot;</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="s2">&quot;Anscombe_quartet_data.csv&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAMPLES&quot;</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="s2">&quot;Anscombe_schema.csv&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">schema_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">metaschema_workbook</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">schema_sheet</span> <span class="o">=</span> <span class="n">metaschema_workbook</span><span class="o">.</span><span class="n">sheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">schema_sheet</span><span class="o">.</span><span class="n">set_schema</span><span class="p">(</span><span class="n">SchemaMaker</span><span class="p">()</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">ExternalSchemaLoader</span><span class="o">.</span><span class="n">META_SCHEMA</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ExternalSchemaLoader</span><span class="p">(</span><span class="n">schema_sheet</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">schema</span> <span class="o">=</span> <span class="n">SchemaMaker</span><span class="p">()</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">sheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">())</span>
<span class="go">Field                                                 Value</span>
<span class="go">object</span>
<span class="go">  x123                                                &#39;x123&#39;</span>
<span class="go">  y1                                                  &#39;y1&#39;</span>
<span class="go">  y2                                                  &#39;y2&#39;</span>
<span class="go">  y3                                                  &#39;y3&#39;</span>
<span class="go">  x4                                                  &#39;x4&#39;</span>
<span class="go">  y4                                                  &#39;y4&#39;</span>

<span class="go">In this case, the :py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAMPLES&quot;</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="s2">&quot;Anscombe_quartet_data.csv&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SAMPLES&quot;</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="s2">&quot;Anscombe_schema.csv&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">schema_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">metaschema_workbook</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">schema_sheet</span> <span class="o">=</span> <span class="n">metaschema_workbook</span><span class="o">.</span><span class="n">sheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">schema_sheet</span><span class="o">.</span><span class="n">set_schema</span><span class="p">(</span><span class="n">SchemaMaker</span><span class="p">()</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">ExternalSchemaLoader</span><span class="o">.</span><span class="n">META_SCHEMA</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ExternalSchemaLoader</span><span class="p">(</span><span class="n">schema_sheet</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">schema</span> <span class="o">=</span> <span class="n">SchemaMaker</span><span class="p">()</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">sheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">())</span>
<span class="go">Field                                                 Value</span>
<span class="go">object</span>
<span class="go">  x123                                                &#39;x123&#39;</span>
<span class="go">  y1                                                  &#39;y1&#39;</span>
<span class="go">  y2                                                  &#39;y2&#39;</span>
<span class="go">  y3                                                  &#39;y3&#39;</span>
<span class="go">  x4                                                  &#39;x4&#39;</span>
<span class="go">  y4                                                  &#39;y4&#39;</span>
</pre></div>
</div>
<p>In this case, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">rows()</span></code> method of the <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance will include all rows.
This means the header row is treated like data when an external schema is applied.</p>
<p>The <strong>process_sheet()</strong> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_sheet</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Row</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s2">&quot;field&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">name()</span></code> method returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> object. This has a <code class="xref py py-meth docutils literal notranslate"><span class="pre">value()</span></code> method that will extract the value
for a given attribute.</p>
</section>
<section id="sheet-and-row">
<h2>Sheet and Row<a class="headerlink" href="#sheet-and-row" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> class contained metadata about the sheet, and a row iterator.
It’s generally used like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="p">:</span> <span class="n">Sheet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">():</span>
        <span class="n">process_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> contains an instance that’s bound to the :py:class:<code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code> and the <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code>.
This will build <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> objects for navigation. Where necessary, this may involve creating
<code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code> objects as part of <code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code> navigation.</p>
</section>
<section id="open-workbook-function">
<h2>open_workbook function<a class="headerlink" href="#open-workbook-function" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stingray.workbook.open_workbook">
<span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">open_workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">WBInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">DInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.open_workbook" title="Link to this definition">¶</a></dt>
<dd><p>CSV Implementation</p>
</dd></dl>

</section>
<section id="name-cleaner-function">
<h2>name_cleaner function<a class="headerlink" href="#name-cleaner-function" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stingray.workbook.name_cleaner">
<span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">name_cleaner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#stingray.workbook.name_cleaner" title="Link to this definition">¶</a></dt>
<dd><p>JSON Schema names for anchors and properties are validated
against patterns defined in places like core/$defs/anchorString.</p>
<p>Anchor names must match the following pattern.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sa">r</span><span class="s2">&quot;^[A-Za-z_][-A-Za-z0-9._]*$&quot;</span>
</pre></div>
</div>
<p>This function replaces illegal characters with “_”</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">name_cleaner</span><span class="p">(</span><span class="s2">&quot;TYPICAL-COBOL&quot;</span><span class="p">)</span>
<span class="go">&#39;TYPICAL-COBOL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_cleaner</span><span class="p">(</span><span class="s2">&quot;common_python&quot;</span><span class="p">)</span>
<span class="go">&#39;common_python&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_cleaner</span><span class="p">(</span><span class="s2">&quot;Not a &#39;good&#39; name&quot;</span><span class="p">)</span>
<span class="go">&#39;Not_a_good_name&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_cleaner</span><span class="p">(</span><span class="s2">&quot;!@#$%^&quot;</span><span class="p">)</span>
<span class="go">&#39;_&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_cleaner</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="core-workbook-sheet-and-row-model">
<h2>Core Workbook, Sheet, and Row Model<a class="headerlink" href="#core-workbook-sheet-and-row-model" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.Workbook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">Workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.Workbook" title="Link to this definition">¶</a></dt>
<dd><p>The <strong>Facade</strong> over all workbooks and COBOL Files.</p>
<p>This provides uniform access to a variety of physical
formats.</p>
<p>Each subclass binds in an Unpacker and the
unique features of that Unpacker.</p>
<p>Generally, a Workbook can be opened one of
three ways</p>
<ul class="simple">
<li><p>Specifically. <code class="docutils literal notranslate"><span class="pre">wb</span> <span class="pre">=</span> <span class="pre">CSV_Workbook(path)</span></code>.
This expects an explicit <code class="docutils literal notranslate"><span class="pre">wb.close()</span></code> to release
resources.</p></li>
<li><p>As a context manager <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CSV_Workbook(path)</span> <span class="pre">as</span> <span class="pre">wb:</span></code>.
The context manager release resources.</p></li>
<li><p>Via the <a class="reference internal" href="#stingray.workbook.open_workbook" title="stingray.workbook.open_workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_workbook()</span></code></a> function.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Workbook.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.Workbook.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes the workbook instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Workbook.sheet">
<span class="sig-name descname"><span class="pre">sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Workbook.sheet" title="Link to this definition">¶</a></dt>
<dd><p>Builds a <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance for the given sheet name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – Name of the sheet</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Workbook.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Workbook.sheet_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields all <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instances in this Workbook.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.Sheet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">Sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workbook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.Sheet" title="Link to this definition">¶</a></dt>
<dd><p>A Sheet of a Workbook. This can also be a table on a page of a Numbers workbook.</p>
<p>It needs a schema binding to describe the content of each row.</p>
<p>Either a Schema is loaded from an external source.
OR an internal Schema loader is used to extract a schema from the first few rows of the sheet.</p>
<p>These can be built manually, but the expectation
is that they’re created by the containing <a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code></a> object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Sheet.row_iter">
<span class="sig-name descname"><span class="pre">row_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><span class="pre">Row</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Sheet.row_iter" title="Link to this definition">¶</a></dt>
<dd><p>Extracts rows from the unpacker’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">instance_iter()</span></code> method.
Applies the schema to create <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
<p>This leverages the two-phase processing of
<a class="reference internal" href="#stingray.workbook.HeadingRowSchemaLoader" title="stingray.workbook.HeadingRowSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeadingRowSchemaLoader</span></code></a> class.
The initial rows pass through the loader’s
<code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code> method.
After the header has built a schema,
the rows are consumed via the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code> of the loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Sheet.rows">
<span class="sig-name descname"><span class="pre">rows</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><span class="pre">Row</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Sheet.rows" title="Link to this definition">¶</a></dt>
<dd><p>Extracts rows from the unpacker’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">instance_iter()</span></code> method.
Applies the schema to create <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
<p>This leverages the two-phase processing of
<a class="reference internal" href="#stingray.workbook.HeadingRowSchemaLoader" title="stingray.workbook.HeadingRowSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeadingRowSchemaLoader</span></code></a> class.
The initial rows pass through the loader’s
<code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code> method.
After the header has built a schema,
the rows are consumed via the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code> of the loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Sheet.set_schema">
<span class="sig-name descname"><span class="pre">set_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Sheet.set_schema" title="Link to this definition">¶</a></dt>
<dd><p>Provides an externally-supplied schema.</p>
<p>This also sets a “do nothing” schema loader
to assure that all rows are processed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>schema</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code> to use.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Sheet.set_schema_loader">
<span class="sig-name descname"><span class="pre">set_schema_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stingray.workbook.SchemaLoader" title="stingray.workbook.SchemaLoader"><span class="pre">SchemaLoader</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Sheet.set_schema_loader" title="Link to this definition">¶</a></dt>
<dd><p>Provides a <a class="reference internal" href="#stingray.workbook.SchemaLoader" title="stingray.workbook.SchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaLoader</span></code></a> that builds a schema by extracting some of the Instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loader</strong> – A subclass of <a class="reference internal" href="#stingray.workbook.HeadingRowSchemaLoader" title="stingray.workbook.HeadingRowSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeadingRowSchemaLoader</span></code></a> that will load schema
and filter rows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.Row">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">Row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Instance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.Row" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper around a <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> object bound to an <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code>.</p>
<p>Note that both Instance and Sheet have the schema. While can be excessive,
it’s also possible the sheet suffers from many schema and the assignment
is on an instance-by-instance basis.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Row.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.Row.dump" title="Link to this definition">¶</a></dt>
<dd><p>Print a formatted dump of this row.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Row.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">Nav</span></a></span></span><a class="headerlink" href="#stingray.workbook.Row.get" title="Link to this definition">¶</a></dt>
<dd><p>Creates a helper <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> and navigates
to the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – An <code class="docutils literal notranslate"><span class="pre">$anchor</span></code> name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> subclass appropriate to the Workbook’s Unpacker.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Row.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">Nav</span></a></span></span><a class="headerlink" href="#stingray.workbook.Row.name" title="Link to this definition">¶</a></dt>
<dd><p>Creates a helper <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> and navigates
to the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – An <code class="docutils literal notranslate"><span class="pre">$anchor</span></code> name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> subclass appropriate to the Workbook’s Unpacker.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.workbook.Row.schema">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">schema</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">Schema</span></a></em><a class="headerlink" href="#stingray.workbook.Row.schema" title="Link to this definition">¶</a></dt>
<dd><p>Extracts the schema from the associated sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.Row.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.Row.values" title="Link to this definition">¶</a></dt>
<dd><p>Creates a helper <code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code> and returns the instances values
for each name in the schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of cell values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="schema-loaders">
<h2>Schema Loaders<a class="headerlink" href="#schema-loaders" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.SchemaLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">SchemaLoader</span></span><a class="headerlink" href="#stingray.workbook.SchemaLoader" title="Link to this definition">¶</a></dt>
<dd><p>Loads a schema.</p>
<p>There are two general cases:</p>
<ul class="simple">
<li><p>Load an external schema from a Workbook.</p></li>
<li><p>Extract the schema from within a sheet
of a workbook. Often this is a heading row,
but it can be more complex.</p></li>
</ul>
<p>The first case is simpler.
The <a class="reference internal" href="#stingray.workbook.ExternalSchemaLoader" title="stingray.workbook.ExternalSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExternalSchemaLoader</span></code></a> subclass
implements a with a <a class="reference internal" href="#stingray.workbook.ExternalSchemaLoader.load" title="stingray.workbook.ExternalSchemaLoader.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ExternalSchemaLoader.load()</span></code></a> method.
This builds a JSONSchema from the rows it finds.
All other external loaders should subclass this.</p>
<p>The <a class="reference internal" href="#stingray.workbook.HeadingRowSchemaLoader" title="stingray.workbook.HeadingRowSchemaLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeadingRowSchemaLoader</span></code></a> subclass
extracts the top row of a sheet and creates a JSONSchema.
The rows are presented as an iterable that’s comsumed
in two phases:</p>
<ol class="arabic simple">
<li><p>The <a class="reference internal" href="#stingray.workbook.SchemaLoader.header" title="stingray.workbook.SchemaLoader.header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code></a> method consumes rows
from an iterator
until it has the required header.</p></li>
<li><p>The <a class="reference internal" href="#stingray.workbook.SchemaLoader.body" title="stingray.workbook.SchemaLoader.body"><code class="xref py py-meth docutils literal notranslate"><span class="pre">body()</span></code></a> method can consume
rows from an iterator to filter
empty rows, footers, or other irrelevancies
from a workbook sheet. An alternative
is to simply return the iterator if no
filtering will be done.</p></li>
</ol>
<p>This superclass specifically does nothing. This is used when an external
schema has been bound to a <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> and no futher processing is
required. For example, when processing COBOL files where the schema is separate.</p>
<p>A schema is returned as a JSONSchema document.
This is almost always converted to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code> instance.
If, however, changes need to be made, or the schema is used outside this module,
it’s already in a standard format.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.SchemaLoader.body">
<span class="sig-name descname"><span class="pre">body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.SchemaLoader.body" title="Link to this definition">¶</a></dt>
<dd><p>Consume the non-header rows, applying an additional filter criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> – The iterator over instances. This is the same iterator
provided to <a class="reference internal" href="#stingray.workbook.SchemaLoader.header" title="stingray.workbook.SchemaLoader.header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code></a>; it will be in the state
left at the end of <a class="reference internal" href="#stingray.workbook.SchemaLoader.header" title="stingray.workbook.SchemaLoader.header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">header()</span></code></a> processing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code> instances for each row after the header.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.SchemaLoader.header">
<span class="sig-name descname"><span class="pre">header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.SchemaLoader.header" title="Link to this definition">¶</a></dt>
<dd><p>Consume the first row or rows to build a schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> – An iterator over instances.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Schema or None if no schema can be parsed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.COBOLSchemaLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">COBOLSchemaLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.COBOLSchemaLoader" title="Link to this definition">¶</a></dt>
<dd><p>The most common case is a single COBOL Schema.
For other, more complex situations, the single schema assumption may not be appropriate.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOLSchemaLoader.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOLSchemaLoader.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads the given COBOL schema from a
copybook file.</p>
<p>If more than one are present, they’re
saved as the <code class="docutils literal notranslate"><span class="pre">schemas</span></code> attribute.</p>
<p>The first <code class="docutils literal notranslate"><span class="pre">01</span></code> level record is returned
as a JSONSchema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>JSONSchema from a COBOL DDE.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.ExternalSchemaLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">ExternalSchemaLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.ExternalSchemaLoader" title="Link to this definition">¶</a></dt>
<dd><p>Read an external source of data to prepare a schema.</p>
<p>A default schema for extrnal metadata is <code class="docutils literal notranslate"><span class="pre">ExternalSchemaLoader.META_SCHEMA</span></code>.
The odds of this being correct are low. The metaschema has three attributes:</p>
<ul class="simple">
<li><p>name. This becomes a property name.</p></li>
<li><p>description. This becomes a property description.</p></li>
<li><p>dataType. This becomes a property type.</p></li>
</ul>
<p>A subclass can do more sophisticated parsing of complex metadata.
For example, COBOL DDE parsing, is an example of complex schema loading.</p>
<p>A subclass could also read JSONSchema directly, if that’s available.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stingray.workbook.ExternalSchemaLoader.META_SCHEMA">
<span class="sig-name descname"><span class="pre">META_SCHEMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'properties':</span> <span class="pre">{'dataType':</span> <span class="pre">{'description':</span> <span class="pre">'field</span> <span class="pre">data</span> <span class="pre">type',</span> <span class="pre">'position':</span> <span class="pre">2,</span> <span class="pre">'type':</span> <span class="pre">'string'},</span> <span class="pre">'description':</span> <span class="pre">{'description':</span> <span class="pre">'field</span> <span class="pre">description',</span> <span class="pre">'position':</span> <span class="pre">1,</span> <span class="pre">'type':</span> <span class="pre">'string'},</span> <span class="pre">'name':</span> <span class="pre">{'description':</span> <span class="pre">'field</span> <span class="pre">name',</span> <span class="pre">'position':</span> <span class="pre">0,</span> <span class="pre">'type':</span> <span class="pre">'string'}},</span> <span class="pre">'title':</span> <span class="pre">'generic</span> <span class="pre">meta</span> <span class="pre">schema</span> <span class="pre">for</span> <span class="pre">external</span> <span class="pre">schema</span> <span class="pre">documents',</span> <span class="pre">'type':</span> <span class="pre">'object'}</span></em><a class="headerlink" href="#stingray.workbook.ExternalSchemaLoader.META_SCHEMA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.ExternalSchemaLoader.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.ExternalSchemaLoader.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads the sheet’s rows and builds a JSONSchema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>JSONSchema instance built from the sbeet.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.HeadingRowSchemaLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">HeadingRowSchemaLoader</span></span><a class="headerlink" href="#stingray.workbook.HeadingRowSchemaLoader" title="Link to this definition">¶</a></dt>
<dd><p>Create a schema from the first row of a workbook sheet.
The “Instance” is expected to be a WBInstance, which is a Sequence of column values,
parsed by a WBUnpacker.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.HeadingRowSchemaLoader.header">
<span class="sig-name descname"><span class="pre">header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.HeadingRowSchemaLoader.header" title="Link to this definition">¶</a></dt>
<dd><p>Creates a JSONSchema from the first row of a sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> – An iterator over instances.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Schema or None if no schema can be parsed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="cobol-files">
<h2>COBOL Files<a class="headerlink" href="#cobol-files" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">COBOL_EBCDIC_File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recfm_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.estruct.html#stingray.estruct.RECFM_Reader" title="stingray.estruct.RECFM_Reader"><span class="pre">RECFM_Reader</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrecl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_File" title="Link to this definition">¶</a></dt>
<dd><p>EBCDIC-encoded files. No newline delimiters are used.</p>
<p>The NDInstance is AnyStr, which is a union of str | bytes.
This is narrower than that, and could be bytes only, not NDInstance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_File.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_File.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes the workbook</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_File.sheet">
<span class="sig-name descname"><span class="pre">sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_File.sheet" title="Link to this definition">¶</a></dt>
<dd><p>Builds a <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instance for the given sheet name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – Name of the sheet (Not used)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#stingray.workbook.COBOL_EBCDIC_Sheet" title="stingray.workbook.COBOL_EBCDIC_Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">COBOL_EBCDIC_Sheet</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_File.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_File.sheet_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields all <a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sheet</span></code></a> instances in this Workbook.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.COBOL_EBCDIC_Sheet" title="stingray.workbook.COBOL_EBCDIC_Sheet"><code class="xref py py-class docutils literal notranslate"><span class="pre">COBOL_EBCDIC_Sheet</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_Sheet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">COBOL_EBCDIC_Sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workbook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_Sheet" title="Link to this definition">¶</a></dt>
<dd><p>The single “Sheet” in a file. This is a container for the rows.
It handles the RECFM and LRECL complexities of variable-length non-delimited records.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_Sheet.row_iter">
<span class="sig-name descname"><span class="pre">row_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><span class="pre">Row</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_Sheet.row_iter" title="Link to this definition">¶</a></dt>
<dd><p>Extracts rows from the unpacker.
Applies the schema to create a <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_Sheet.rows">
<span class="sig-name descname"><span class="pre">rows</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><span class="pre">Row</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_Sheet.rows" title="Link to this definition">¶</a></dt>
<dd><p>Extracts rows from the unpacker.
Applies the schema to create a <a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stingray.workbook.Row" title="stingray.workbook.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_EBCDIC_Sheet.set_schema">
<span class="sig-name descname"><span class="pre">set_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Sheet" title="stingray.workbook.Sheet"><span class="pre">Sheet</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_EBCDIC_Sheet.set_schema" title="Link to this definition">¶</a></dt>
<dd><p>Sets the schema for this COBOL file.</p>
<p>If the workbook has an LRECL alread set,
this is used to process records.</p>
<p>If the workbook did not have an LRECL set,
the Schema is examined to see if an LRECL
can be computed.</p>
<p>This extracts the LRECL eagerly to make the it visible
as soon as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>schema</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code> instance built from the COBOL copybook.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_Text_File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">COBOL_Text_File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.COBOL_Text_File" title="Link to this definition">¶</a></dt>
<dd><p>Facade for COBOL data in native text
with in a fixed format, newline delimited.</p>
<p>This uses the <code class="xref py py-class docutils literal notranslate"><span class="pre">TextUnpacker</span></code> unpacker.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.COBOL_Text_File.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.COBOL_Text_File.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes the Workbook.</p>
</dd></dl>

</dd></dl>

</section>
<section id="csv-workbooks">
<h2>CSV Workbooks<a class="headerlink" href="#csv-workbooks" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.CSVUnpacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">CSVUnpacker</span></span><a class="headerlink" href="#stingray.workbook.CSVUnpacker" title="Link to this definition">¶</a></dt>
<dd><p>Upacker that wraps the <code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code> module.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.CSVUnpacker.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.CSVUnpacker.close" title="Link to this definition">¶</a></dt>
<dd><p>Close the CSV file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.CSVUnpacker.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">WBInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.CSVUnpacker.instance_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields rows from the CSV File.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> – name of the sheet (not used)</p></li>
<li><p><strong>kwargs</strong> – Additional arguments provided to <code class="xref py py-func docutils literal notranslate"><span class="pre">csv.reader()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>rows from the CSV file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.CSVUnpacker.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.CSVUnpacker.open" title="Link to this definition">¶</a></dt>
<dd><p>Opens a CSV file for unpacking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Path to the CSV file.</p></li>
<li><p><strong>file_object</strong> – Optional Open IO object. If omitted the name is opened.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.CSVUnpacker.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.CSVUnpacker.sheet_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields all sheet names.
For CSV files there’s only one sheet,
and the name is “”.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p>Literal[“”]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.CSV_Workbook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">CSV_Workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.CSV_Workbook" title="Link to this definition">¶</a></dt>
<dd><p>Facade for CSV and TAB Workbooks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.CSV_Workbook.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.CSV_Workbook.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes the workbook.</p>
</dd></dl>

</dd></dl>

</section>
<section id="json-workbooks">
<h2>JSON Workbooks<a class="headerlink" href="#json-workbooks" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.JSONUnpacker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">JSONUnpacker</span></span><a class="headerlink" href="#stingray.workbook.JSONUnpacker" title="Link to this definition">¶</a></dt>
<dd><p>Unpacker that wraps the <code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code> module..</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.JSONUnpacker.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.JSONUnpacker.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes the NDJSON file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.JSONUnpacker.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">DInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.JSONUnpacker.instance_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields items from the NDJSON File.
Documents are delimited with newlines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> – name of the sheet (not used)</p></li>
<li><p><strong>kwargs</strong> – Additional arguments provided to <code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>rows from the NDJSON file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.JSONUnpacker.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.JSONUnpacker.open" title="Link to this definition">¶</a></dt>
<dd><p>Opens the NDJSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Path to the file.</p></li>
<li><p><strong>file_object</strong> – Optional Open IO object. If omitted the name is opened.</p></li>
<li><p><strong>kwargs</strong> – KW arguments (not used)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.JSONUnpacker.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.JSONUnpacker.sheet_iter" title="Link to this definition">¶</a></dt>
<dd><p>Yields all sheet names.
For NDJSON files there’s only one sheet,
and the name is “”.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p>Literal[“”]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.JSON_Workbook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">JSON_Workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.JSON_Workbook" title="Link to this definition">¶</a></dt>
<dd><p>Facade for NDJSON Workbooks. Also called JSON Newline.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.JSON_Workbook.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.workbook.JSON_Workbook.close" title="Link to this definition">¶</a></dt>
<dd><p>Closees the Workbook file.</p>
</dd></dl>

</dd></dl>

</section>
<section id="workbook-file-registry">
<h2>Workbook File Registry<a class="headerlink" href="#workbook-file-registry" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.workbook.WBFileRegistry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stingray.workbook.</span></span><span class="sig-name descname"><span class="pre">WBFileRegistry</span></span><a class="headerlink" href="#stingray.workbook.WBFileRegistry" title="Link to this definition">¶</a></dt>
<dd><p>A global registry for Workbook classes and their associated file suffixes.
It makes an open_workbook() function that can open a wide variety of file types.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_registry</span> <span class="o">=</span> <span class="n">WBFileRegistry</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@file_registry</span><span class="o">.</span><span class="n">file_suffix</span><span class="p">(</span><span class="s2">&quot;.xyz&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">XYZ_Workbook</span><span class="p">(</span><span class="n">Workbook</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_registry</span><span class="o">.</span><span class="n">suffix_map</span><span class="p">[</span><span class="s2">&quot;.xyz&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">XYZ_Workbook</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.WBFileRegistry.file_suffix">
<span class="sig-name descname"><span class="pre">file_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">name_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">WBInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">DInstance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">WBInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">DInstance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.WBFileRegistry.file_suffix" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to adds a file suffix and associated
class to the registry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name_list</strong> – String suffix or sequence of suffices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorator that’s applied to a class definition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.workbook.WBFileRegistry.open_workbook">
<span class="sig-name descname"><span class="pre">open_workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">NDInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">WBInstance</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><span class="pre">Workbook</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.schema_instance.html#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">DInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.workbook.WBFileRegistry.open_workbook" title="Link to this definition">¶</a></dt>
<dd><p>Opens an appropriate subclass of <a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code></a> for the given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source</strong> – Path to the Workbook</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <a class="reference internal" href="#stingray.workbook.Workbook" title="stingray.workbook.Workbook"><code class="xref py py-class docutils literal notranslate"><span class="pre">Workbook</span></code></a> subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stingray.workbook.file_registry.file_suffix">
<span class="sig-prename descclassname"><span class="pre">file_registry.</span></span><span class="sig-name descname"><span class="pre">file_suffix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stingray.workbook.file_registry.file_suffix" title="Link to this definition">¶</a></dt>
<dd><p>A decorator used to mark a class
with the file extensions it handles.</p>
</dd></dl>

</section>
<section id="legacy-api-concept">
<h2>Legacy API Concept<a class="headerlink" href="#legacy-api-concept" title="Link to this heading">¶</a></h2>
<p>The version 4.0 concept for the API looked like this:</p>
<p><strong>Internal, Embedded Schema</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stingray.workbook</span> <span class="kn">import</span> <span class="n">open_workbook</span><span class="p">,</span> <span class="n">EmbeddedSchemaSheet</span><span class="p">,</span> <span class="n">HeadingRowSchemaLoader</span>

<span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">EmbeddedSchemaSheet</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">HeadingRowSchemaLoader</span><span class="p">)</span>
    <span class="n">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>External Schema</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stingray.workbook</span> <span class="kn">import</span> <span class="n">open_workbook</span><span class="p">,</span> <span class="n">ExternalSchemaSheet</span><span class="p">,</span> <span class="n">ExternalSchemaLoader</span>

<span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">schema_wb</span><span class="p">:</span>
    <span class="n">esl</span> <span class="o">=</span> <span class="n">ExternalSchemaLoader</span><span class="p">(</span><span class="n">schema_wb</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Schema&#39;</span><span class="p">)</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">esl</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="k">with</span> <span class="n">open_workbook</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">ExternalSchemaSheet</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
    <span class="n">process_sheet</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span>
</pre></div>
</div>
<p>If necessary, the external schema can have a meta-schema. It may be necessary to define a conversion function to create a useful JSON Schema from a schema workbook.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/Stingray_belon1553_small.png" alt="Logo of Stingray-Reader"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">Stingray-Reader</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer.html">Using <strong>Stingray Reader</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design.html">Design Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background.html">Additional Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demo/index.html">Demo Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">stingray API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../todo.html">The TODO List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Commercial Use</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">stingray API Reference</a><ul>
      <li>Previous: <a href="stingray.cobol_parser.html" title="previous chapter">stingray.cobol_parser</a></li>
      <li>Next: <a href="stingray.implementations.html" title="next chapter">stingray.implementations</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2021, S.Lott.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/apidoc/modules/stingray.workbook.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>