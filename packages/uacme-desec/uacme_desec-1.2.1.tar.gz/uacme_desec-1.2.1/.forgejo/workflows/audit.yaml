# SPDX-FileCopyrightText: 2024 OpenBit
#
# SPDX-License-Identifier: CC0-1.0

# NB: We run git clone instead of the checkout action
# until the action supports SHA256
# https://github.com/actions/checkout/issues/1843
on: [push]
jobs:
  bandit:
    container:
      image: python:alpine
    steps:
      - run: apk --update add git
      - run: |
          git clone ${{ env.GITHUB_SERVER_URL }}/${{ env.GITHUB_REPOSITORY }} ${{ env.GITHUB_WORKSPACE }}
          git -C ${{ env.GITHUB_WORKSPACE }} checkout ${{ env.GITHUB_SHA }}
      - run: python -m pip install bandit
      - run: python -m bandit -r src/
